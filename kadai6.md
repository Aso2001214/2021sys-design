@startuml
activate ユーザー
alt 行きたい国が決まっている
ユーザー->ユーザー:国名・地域名情報を入力し送信ボタン入力
ユーザー->webサーバー:送信した情報
webサーバー->DBサーバー:入力された国名・地域名情報を送信
DBサーバー->DBサーバー:入力された国名・地域名情報を検索
DBサーバー->webサーバー:検索結果
alt 入力された国名・地域名の一致
webサーバー->ユーザー:入力された国・地域の情報表示
else 入力された国名・地域名の不一致
webサーバー->ユーザー:一致するデータがないと表示
end
else 行きたい国が決まってない
ユーザー->ユーザー:キーワードを選択し送信ボタン入力
ユーザー->webサーバー:送信した情報
webサーバー->DBサーバー:入力されたキーワードを送信
DBサーバー->DBサーバー:入力されたキーワードを検索
DBサーバー->webサーバー:検索結果
webサーバー->ユーザー:一致したキーワードのなかで一番多い国・地域を出力
end

opt ガイド購入
alt 商品の在庫あり
webサーバー->ユーザー:購入情報の提示
else 在庫なし
webサーバー->ユーザー:完売と表示
end 
end


opt 購入確定
ユーザー->webサーバー:購入方法選択&住所情報
  alt カード決済
  ユーザー->webサーバー:SSL対応決済ページでクレジットカード情報を入力
  webサーバー->決済サーバー:決済サーバーを経由し各決済機関に決済データを送信
  決済サーバー->webサーバー:決済結果返答
  alt 決済可
  webサーバー->ユーザー:決済が終了したと表示
  else 決済不可
  webサーバー->ユーザー:承認エラーが起きたと表示
  end
  end
  webサーバー->ユーザー:商品到着予定を表示
  end
deactivate ユーザー
@enduml
